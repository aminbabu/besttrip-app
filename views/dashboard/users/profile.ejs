<!DOCTYPE html>
<html lang="en">
<!--begin::Head-->
<%- include('../partials/head', { title }) %>
<!--end::Head-->
<!--begin::Body-->

<body id="kt_app_body" data-kt-app-layout="light-sidebar" data-kt-app-header-fixed="true" data-kt-app-sidebar-enabled="true" data-kt-app-sidebar-fixed="true" data-kt-app-sidebar-hoverable="true" data-kt-app-sidebar-push-header="true" data-kt-app-sidebar-push-toolbar="true" data-kt-app-sidebar-push-footer="true" data-kt-app-toolbar-enabled="true" class="app-default">
  <!--begin::Theme mode setup on page load-->
  <%- include('../partials/theme-mode.ejs') %>
  <!--end::Theme mode setup on page load-->
  <!--begin::App-->
  <div class="d-flex flex-column flex-root app-root" id="kt_app_root">
    <!--begin::Page-->
    <div class="app-page flex-column flex-column-fluid" id="kt_app_page">
      <!--begin::Header-->
      <%- include('../partials/header', { user }) %>
      <!--end::Header-->
      <!--begin::Wrapper-->
      <div class="app-wrapper flex-column flex-row-fluid" id="kt_app_wrapper">
        <!--begin::Sidebar-->
        <%- include('../partials/sidebar') %>
        <!--end::Sidebar-->
        <!--begin::Main-->
        <div class="app-main flex-column flex-row-fluid" id="kt_app_main">
          <!--begin::Content wrapper-->
          <div class="d-flex flex-column flex-column-fluid">
            <!--begin::Toolbar-->
            <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
              <!--begin::Toolbar container-->
              <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
                <!--begin::Page title-->
                <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
                  <!--begin::Title-->
                  <h1 class="page-heading d-flex text-gray-900 fw-bold fs-3 flex-column justify-content-center my-0">
                    <%= user.name %>
                  </h1>
                  <!--end::Title-->
                  <!--begin::Breadcrumb-->
                  <ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
                    <!--begin::Item-->
                    <li class="breadcrumb-item text-muted">
                      <a href="/dashboard" class="text-muted text-hover-primary">Home</a>
                    </li>
                    <!--end::Item-->
                    <!--begin::Item-->
                    <li class="breadcrumb-item">
                      <span class="bullet bg-gray-500 w-5px h-2px"></span>
                    </li>
                    <!--end::Item-->
                    <!--begin::Item-->
                    <li class="breadcrumb-item text-muted">Profile</li>
                    <!--end::Item-->
                  </ul>
                  <!--end::Breadcrumb-->
                </div>
                <!--end::Page title-->
              </div>
              <!--end::Toolbar container-->
            </div>
            <!--end::Toolbar-->
            <!--begin::Content-->
            <div id="kt_app_content" class="app-content flex-column-fluid">
              <!--begin::Content container-->
              <div id="kt_app_content_container" class="app-container container-xxl">
                <!--begin::Layout-->
                <div class="d-flex flex-column flex-lg-row">
                  <!--begin::Sidebar-->
                  <div class="flex-column flex-lg-row-auto w-lg-250px w-xl-350px mb-10">
                    <!--begin::Card-->
                    <div class="card mb-5 mb-xl-8">
                      <!--begin::Card body-->
                      <div class="card-body">
                        <!--begin::Summary-->
                        <!--begin::User Info-->
                        <div class="d-flex flex-center flex-column py-5">
                          <!--begin::Avatar-->
                          <div class="symbol symbol-100px symbol-circle mb-7">
                            <% if (user.avatar) { %>
                            <img src="/<%= user.avatar %>" alt="<%= user.name %>" />
                            <% } else { %>
                            <span class="symbol-label fs-2 fw-bold text-uppercase"><%= user.name[0] %></span>
                            <% } %>
                          </div>
                          <!--end::Avatar-->
                          <!--begin::Name-->
                          <a href="#" class="fs-3 text-gray-800 text-hover-primary fw-bold mb-3"><%= user.name %></a>
                          <!--end::Name-->
                          <!--begin::Position-->
                          <div class="mb-5">
                            <!--begin::Position-->
                            <div class="fs-5 fw-semibold text-muted text-capitalize mb-6"><%= user.role %></div>
                            <!--end::Position-->
                          </div>
                          <!--end::Position-->
                        </div>
                        <!--end::User Info-->
                        <!--end::Summary-->
                        <!--begin::Details toggle-->
                        <div class="d-flex flex-stack fs-4 py-3">
                          <div class="fw-bold rotate collapsible" data-bs-toggle="collapse" href="#kt_user_view_details" role="button" aria-expanded="false" aria-controls="kt_user_view_details">
                            Details
                            <span class="ms-2 rotate-180">
                              <i class="ki-duotone ki-down fs-3"></i>
                            </span>
                          </div>
                          <span data-bs-toggle="tooltip" data-bs-trigger="hover" title="Edit customer details">
                            <a href="#" class="btn btn-sm btn-light-primary" data-bs-toggle="modal" data-bs-target="#kt_modal_update_details">Edit</a>
                          </span>
                        </div>
                        <!--end::Details toggle-->
                        <div class="separator"></div>
                        <!--begin::Details content-->
                        <div id="kt_user_view_details" class="collapse show">
                          <div class="pb-5 fs-6">
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Stuff ID</div>
                            <div class="text-gray-600">ID-<%= user.userID %></div>
                            <!--begin::Details item-->
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Email Address</div>
                            <div class="text-gray-600"><%= user.email %></div>
                            <!--begin::Details item-->
                            <%  if (user.phone) { %>
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Phone Number</div>
                            <div class="text-gray-600"><%= user.phone %></div>
                            <!--begin::Details item-->
                            <% } %>
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Account Status</div>
                            <div class="badge badge-light-success text-uppercase">
                              <%= user.status %>
                            </div>
                            <!--begin::Details item-->
                            <% if (user.address) { %>
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Address</div>
                            <div class="text-gray-600">
                              <%= user.address %>, <br>
                              <%= user.city %> - <%= user.postalCode %>, <br>
                              <%= user.state %>, <%= user.country %>
                            </div>
                            <!--begin::Details item-->
                            <% } %>
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Joined Date</div>
                            <div class="text-gray-600">
                              <%= user.createdAt %>
                            </div>
                            <!--begin::Details item-->
                            <% if (user?.histories.lastLogin) { %>
                            <!--begin::Details item-->
                            <div class="fw-bold mt-5">Last Login</div>
                            <div class="text-gray-600">
                              <%= user?.histories.lastLogin %>
                            </div>
                            <!--begin::Details item-->
                            <% } %>
                          </div>
                        </div>
                        <!--end::Details content-->
                      </div>
                      <!--end::Card body-->
                    </div>
                    <!--end::Card-->
                  </div>
                  <!--end::Sidebar-->
                  <!--begin::Content-->
                  <div class="flex-lg-row-fluid ms-lg-15">
                    <!--begin:::Tabs-->
                    <ul class="nav nav-custom nav-tabs nav-line-tabs nav-line-tabs-2x border-0 fs-4 fw-semibold mb-8">
                      <!--begin:::Tab item-->
                      <li class="nav-item">
                        <a class="nav-link text-active-primary pb-4 active" data-kt-countup-tabs="true" data-bs-toggle="tab" href="#kt_user_view_overview_security">Security</a>
                      </li>
                      <!--end:::Tab item-->
                      <!--begin:::Tab item-->
                      <li class="nav-item">
                        <a class="nav-link text-active-primary pb-4" data-bs-toggle="tab" href="#kt_user_view_overview_events_and_logs_tab">Events & Logs</a>
                      </li>
                      <!--end:::Tab item-->
                      <!--begin:::Tab item-->
                      <li class="nav-item ms-auto">
                        <!--begin::Action menu-->
                        <a href="#" class="btn btn-primary ps-7" data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end">Actions <i class="ki-duotone ki-down fs-2 me-0"></i></a>
                        <!--begin::Menu-->
                        <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-800 menu-state-bg-light-primary fw-semibold py-4 w-250px fs-6" data-kt-menu="true">
                          <!--begin::Menu item-->
                          <div class="menu-item px-5">
                            <div class="menu-content text-muted pb-2 px-5 fs-7 text-uppercase">
                              Account
                            </div>
                          </div>
                          <!--end::Menu item-->
                          <!--begin::Menu item-->
                          <div class="menu-item px-5">
                            <a href="/api/users/self/disable" class="menu-link px-5" id="kt_users_disable_account">
                              Disable Account
                            </a>
                          </div>
                          <!--end::Menu item-->
                          <!--begin::Menu item-->
                          <div class="menu-item px-5">
                            <a href="/api/users/self" class="menu-link text-danger px-5" id="kt_users_delete_account">
                              Delete Account
                            </a>
                          </div>
                          <!--end::Menu item-->
                        </div>
                        <!--end::Menu-->
                        <!--end::Menu-->
                      </li>
                      <!--end:::Tab item-->
                    </ul>
                    <!--end:::Tabs-->
                    <!--begin:::Tab content-->
                    <div class="tab-content" id="myTabContent">
                      <!--begin:::Tab pane-->
                      <div class="tab-pane fade show active" id="kt_user_view_overview_security" role="tabpanel">
                        <!--begin::Card-->
                        <div class="card pt-4 mb-6 mb-xl-9">
                          <!--begin::Card header-->
                          <div class="card-header border-0">
                            <!--begin::Card title-->
                            <div class="card-title">
                              <h2>Profile</h2>
                            </div>
                            <!--end::Card title-->
                          </div>
                          <!--end::Card header-->
                          <!--begin::Card body-->
                          <div class="card-body pt-0 pb-5">
                            <!--begin::Table wrapper-->
                            <div class="table-responsive">
                              <!--begin::Table-->
                              <table class="table align-middle table-row-dashed gy-5">
                                <tbody class="fs-6 fw-semibold text-gray-600">
                                  <tr>
                                    <td>Password</td>
                                    <td>********</td>
                                    <td class="text-end">
                                      <button type="button" class="btn btn-icon btn-active-light-primary w-30px h-30px ms-auto" data-bs-toggle="modal" data-bs-target="#kt_modal_update_password">
                                        <i class="ki-duotone ki-pencil fs-3">
                                          <span class="path1"></span>
                                          <span class="path2"></span>
                                        </i>
                                      </button>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                              <!--end::Table-->
                            </div>
                            <!--end::Table wrapper-->
                          </div>
                          <!--end::Card body-->
                        </div>
                        <!--end::Card-->
                        <!--begin::Card-->
                        <div class="card pt-4 mb-6 mb-xl-9">
                          <!--begin::Card header-->
                          <div class="card-header flex-lg-nowrap border-0 pb-4">
                            <!--begin::Card title-->
                            <div class="card-title flex-column">
                              <h2 class="mb-1">Two Step Authentication</h2>
                              <div class="fs-6 fw-semibold text-muted">
                                Keep your account extra secure with a second
                                authentication step.
                              </div>
                            </div>
                            <!--end::Card title-->
                            <!--begin::Card toolbar-->
                            <div class="card-toolbar flex-shrink-0">
                              <!--begin::Add-->
                              <button type="button" class="btn btn-light-primary btn-sm" data-bs-toggle="modal" data-bs-target="#kt_modal_add_one_time_password">
                                <i class="ki-duotone ki-fingerprint-scanning fs-3">
                                  <span class="path1"></span>
                                  <span class="path2"></span>
                                  <span class="path3"></span>
                                  <span class="path4"></span>
                                  <span class="path5"></span> </i>
                                Enable Two Step Authentication
                              </button>
                              <!--end::Add-->
                            </div>
                            <!--end::Card toolbar-->
                          </div>
                          <!--end::Card header-->
                        </div>
                        <!--end::Card-->
                      </div>
                      <!--end:::Tab pane-->
                      <% if (user?.histories?.length) { %>
                      <!--begin:::Tab pane-->
                      <div class="tab-pane fade" id="kt_user_view_overview_events_and_logs_tab" role="tabpanel">
                        <!--begin::Card-->
                        <div class="card pt-4 mb-6 mb-xl-9">
                          <!--begin::Card header-->
                          <div class="card-header border-0">
                            <!--begin::Card title-->
                            <div class="card-title">
                              <h2>Login Sessions</h2>
                            </div>
                            <!--end::Card title-->
                            <!--begin::Card toolbar-->
                            <div class="card-toolbar">
                              <!--begin::Toolbar-->
                              <div class="d-flex justify-content-end gap-3" data-kt-users-login-session-toolbar="base">
                                <!--begin::Filter-->
                                <button type="button" class="btn btn-sm btn-flex btn-light-primary" id="kt_modal_users_login_session">
                                  <i class="ki-duotone ki-entrance-right fs-3">
                                    <span class="path1"></span>
                                    <span class="path2"></span>
                                  </i>
                                  Sign out all sessions
                                </button>
                                <!--end::Filter-->
                              </div>
                              <!--end::Toolbar-->
                              <!--begin::Group actions-->
                              <div class="d-flex justify-content-end align-items-center d-none" data-kt-users-login-session-toolbar="selected">
                                <div class="fw-bold me-5">
                                  <span class="me-2" data-kt-users-login-session-select="selected_count"></span>Selected
                                </div>
                                <button type="button" class="btn btn-danger" data-kt-users-login-session-select="delete_selected">
                                  Delete Selected
                                </button>
                              </div>
                              <!--end::Group actions-->
                            </div>
                            <!--end::Card toolbar-->
                          </div>
                          <!--end::Card header-->
                          <!--begin::Card body-->
                          <div class="card-body pt-0 pb-5">
                            <!--begin::Table-->
                            <table class="table align-middle table-row-dashed fs-6 gy-5" id="kt_table_users_login_session">
                              <thead>
                                <tr class="text-start text-muted fw-bold fs-7 text-uppercase gs-0">
                                  <th class="w-10px pe-2">
                                    <div class="form-check form-check-sm form-check-custom form-check-solid me-3">
                                      <input class="form-check-input" type="checkbox" data-kt-check="true" data-kt-check-target="#kt_table_users_login_session .form-check-input" value="1" />
                                    </div>
                                  </th>
                                  <th class="min-w-125px">Last Login</th>
                                  <th class="min-w-125px">IP address</th>
                                  <th class="min-w-125px">Status</th>
                                  <th class="min-w-400px" style="white-space: normal;">
                                    Browser/Device
                                  </th>
                                  <th class="min-w-125px">Location</th>
                                  <th class="text-end min-w-70px">
                                    Actions
                                  </th>
                                </tr>
                              </thead>
                              <tbody class="text-gray-600 fw-semibold">
                                <% user?.histories.forEach((history) => { %>
                                <tr>
                                  <td>
                                    <div class="form-check form-check-sm form-check-custom form-check-solid">
                                      <input class="form-check-input" type="checkbox" value="<%= history._id %>" />
                                    </div>
                                  </td>
                                  <td>
                                    <div class="d-flex flex-column">
                                      <span class="text-muted fw-bold"><%= history.lastLoginDaysAgo %></span>
                                      <span><%= history.lastLogin %></span>
                                    </div>
                                  </td>
                                  <td><%= history.ipAddress %></td>
                                  <td>
                                    <span class="badge badge-light-<%= history.status === 'active' ? 'success' : 'danger' %> px-4 py-3 text-capitalize">
                                      <%= history.status %>
                                    </span>
                                  </td>
                                  <td style="white-space: normal;"><%= history.userAgent %></td>
                                  <td><%= history.location %></td>
                                  <td class="text-end">
                                    <a href="#" class="btn btn-light btn-active-light-primary btn-sm" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">Actions
                                      <i class="ki-duotone ki-down fs-5 m-0"></i></a>
                                    <!--begin::Menu-->
                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-semibold fs-7 w-125px py-4" data-kt-menu="true">
                                      <!--begin::Menu item-->
                                      <div class="menu-item px-3">
                                        <a href="/api/history/sign-out/<%= history._id %>" class="menu-link px-3" data-kt-users-login-session-table-filter="sign_out">Sign out</a>
                                      </div>
                                      <!--end::Menu item-->
                                      <!--begin::Menu item-->
                                      <div class="menu-item px-3">
                                        <a href="/api/history/block/<%= history._id %>" class="menu-link px-3" data-kt-users-login-session-table-filter="block">Block</a>
                                      </div>
                                      <!--end::Menu item-->
                                      <!--begin::Menu item-->
                                      <div class="menu-item px-3">
                                        <a href="/api/history/<%= history._id %>" class="menu-link px-3" data-kt-users-login-session-table-filter="delete_row">Delete</a>
                                      </div>
                                      <!--end::Menu item-->
                                    </div>
                                    <!--end::Menu-->
                                  </td>
                                </tr>
                                <% }) %>
                              </tbody>
                            </table>
                            <!--end::Table-->
                          </div>
                          <!--end::Card body-->
                        </div>
                        <!--end::Card-->
                      </div>
                      <!--end:::Tab pane-->
                      <% } %>
                    </div>
                    <!--end:::Tab content-->
                  </div>
                  <!--end::Content-->
                </div>
                <!--end::Layout-->
                <!--begin::Modals-->
                <!--begin::Modal - Update user details-->
                <div class="modal fade" id="kt_modal_update_details" tabindex="-1" aria-hidden="true">
                  <!--begin::Modal dialog-->
                  <div class="modal-dialog modal-dialog-centered mw-650px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                      <!--begin::Form-->
                      <form class="form" id="kt_modal_update_user_form" data-kt-redirect-url="/dashboard/users/profile" action="/api/users/self" method="post">
                        <!--begin::Modal header-->
                        <div class="modal-header" id="kt_modal_update_user_header">
                          <!--begin::Modal title-->
                          <h2 class="fw-bold">Update User Details</h2>
                          <!--end::Modal title-->
                          <!--begin::Close-->
                          <div class="btn btn-icon btn-sm btn-active-icon-primary" data-kt-users-modal-action="close">
                            <i class="bi bi-x fs-2x"></i>
                          </div>
                          <!--end::Close-->
                        </div>
                        <!--end::Modal header-->
                        <!--begin::Modal body-->
                        <div class="modal-body py-10 px-lg-17">
                          <!--begin::Scroll-->
                          <div class="d-flex flex-column scroll-y me-n7 pe-7" id="kt_modal_update_user_scroll" data-kt-scroll="true" data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-max-height="auto" data-kt-scroll-dependencies="#kt_modal_update_user_header" data-kt-scroll-wrappers="#kt_modal_update_user_scroll" data-kt-scroll-offset="300px">
                            <!--begin::User toggle-->
                            <div class="fw-bolder fs-3 rotate collapsible mb-7" data-bs-toggle="collapse" href="#kt_modal_update_user_user_info" role="button" aria-expanded="false" aria-controls="kt_modal_update_user_user_info">
                              User Information
                              <span class="ms-2 rotate-180">
                                <i class="ki-duotone ki-down fs-3"></i>
                              </span>
                            </div>
                            <!--end::User toggle-->
                            <!--begin::User form-->
                            <div id="kt_modal_update_user_user_info" class="collapse show">
                              <!--begin::Input group-->
                              <div class="mb-7">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">
                                  <span>Update Avatar</span>
                                  <span class="ms-1" data-bs-toggle="tooltip" title="Allowed file types: png, jpg, jpeg.">
                                    <i class="ki-duotone ki-information fs-7">
                                      <span class="path1"></span>
                                      <span class="path2"></span>
                                      <span class="path3"></span>
                                    </i>
                                  </span>
                                </label>
                                <!--end::Label-->
                                <!--begin::Image input wrapper-->
                                <div class="mt-1">
                                  <!--begin::Image placeholder-->
                                  <style>
                                    .image-input-placeholder {
                                      background-image: url("/assets/media/svg/avatars/blank.svg");
                                    }

                                    [data-bs-theme="dark"] .image-input-placeholder {
                                      background-image: url("/assets/media/svg/avatars/blank-dark.svg");
                                    }
                                  </style>
                                  <!--end::Image placeholder-->
                                  <!--begin::Image input-->
                                  <div class="image-input image-input-outline image-input-placeholder" data-kt-image-input="true">
                                    <!--begin::Preview existing avatar-->
                                    <% if (user.avatar) { %>
                                    <div class="image-input-wrapper w-125px h-125px" style="
                                          background-image: url('/<%= user.avatar %>');
                                        "></div>
                                    <% } else { %>
                                    <div class="image-input-wrapper w-125px h-125px" style="
                                          background-image: url('/assets/media/avatars/blank.png');
                                        "></div>
                                    <% } %>
                                    <!--end::Preview existing avatar-->
                                    <!--begin::Edit-->
                                    <label class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" data-kt-image-input-action="change" data-bs-toggle="tooltip" title="Change avatar">
                                      <i class="ki-duotone ki-pencil fs-7">
                                        <span class="path1"></span>
                                        <span class="path2"></span>
                                      </i>
                                      <!--begin::Inputs-->
                                      <input type="file" name="avatar" accept=".png, .jpg, .jpeg" />
                                      <input type="hidden" name="avatar_remove" />
                                      <!--end::Inputs-->
                                    </label>
                                    <!--end::Edit-->
                                    <!--begin::Cancel-->
                                    <span class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" data-kt-image-input-action="cancel" data-bs-toggle="tooltip" title="Cancel avatar">
                                      <i class="bi bi-x fs-2"></i>
                                    </span>
                                    <!--end::Cancel-->
                                    <!--begin::Remove-->
                                    <span class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" data-kt-image-input-action="remove" data-bs-toggle="tooltip" title="Remove avatar">
                                      <i class="bi bi-x fs-2"></i>
                                    </span>
                                    <!--end::Remove-->
                                  </div>
                                  <!--end::Image input-->
                                </div>
                                <!--end::Image input wrapper-->
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <div class="fv-row mb-7">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">
                                  <span class="required">Full Name</span>
                                </label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <input type="text" class="form-control form-control-solid" placeholder="" name="name" value="<%= user.name %>" />
                                <!--end::Input-->
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <div class="fv-row mb-7">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">
                                  <span class="required">Email Address</span>
                                  <span class="ms-1" data-bs-toggle="tooltip" title="Email address must be active">
                                    <i class="ki-duotone ki-information fs-7">
                                      <span class="path1"></span>
                                      <span class="path2"></span>
                                      <span class="path3"></span>
                                    </i>
                                  </span>
                                </label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <input type="email" class="form-control form-control-solid" placeholder="" name="email" value="<%= user.email %>" />
                                <!--end::Input-->
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <div class="fv-row mb-7">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Phone Number</label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <input type="text" class="form-control form-control-solid" placeholder="" name="phone" value="<%= user?.phone %>" />
                                <!--end::Input-->
                              </div>
                              <!--begin::Input group-->
                              <div class="fv-row mb-7">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Date of Birth</label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <input class="form-control form-control-solid" name="dob" placeholder="Pick a date" id="kt_datepicker_user_dob" />
                                <!--end::Input-->
                                <script>
                                  document.addEventListener('DOMContentLoaded', function() {
                                    flatpickr("#kt_datepicker_user_dob", {
                                      defaultDate: "<%= user?.dob %>",
                                      dateFormat: "Y-m-d"
                                    });
                                  });
                                </script>
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <!-- <div class="fv-row mb-15"> -->
                              <!--begin::Label-->
                              <!-- <label class="fs-6 fw-semibold mb-2">Language</label> -->
                              <!--end::Label-->
                              <!--begin::Input-->
                              <!-- <select name="language" aria-label="Select a Language" data-control="select2" data-placeholder="Select a Language..." class="form-select form-select-solid" data-dropdown-parent="#kt_modal_update_details">
                                  <option></option>
                                  <option value="id">
                                    Bahasa Indonesia - Indonesian
                                  </option>
                                  <option value="msa">
                                    Bahasa Melayu - Malay
                                  </option>
                                  <option value="ca">Català - Catalan</option>
                                  <option value="cs">Čeština - Czech</option>
                                  <option value="da">Dansk - Danish</option>
                                  <option value="de">Deutsch - German</option>
                                  <option value="en">English</option>
                                  <option value="en-gb">
                                    English UK - British English
                                  </option>
                                  <option value="es">
                                    Español - Spanish
                                  </option>
                                  <option value="fil">Filipino</option>
                                  <option value="fr">
                                    Français - French
                                  </option>
                                  <option value="ga">
                                    Gaeilge - Irish (beta)
                                  </option>
                                  <option value="gl">
                                    Galego - Galician (beta)
                                  </option>
                                  <option value="hr">
                                    Hrvatski - Croatian
                                  </option>
                                  <option value="it">
                                    Italiano - Italian
                                  </option>
                                  <option value="hu">
                                    Magyar - Hungarian
                                  </option>
                                  <option value="nl">
                                    Nederlands - Dutch
                                  </option>
                                  <option value="no">
                                    Norsk - Norwegian
                                  </option>
                                  <option value="pl">Polski - Polish</option>
                                  <option value="pt">
                                    Português - Portuguese
                                  </option>
                                  <option value="ro">
                                    Română - Romanian
                                  </option>
                                  <option value="sk">
                                    Slovenčina - Slovak
                                  </option>
                                  <option value="fi">Suomi - Finnish</option>
                                  <option value="sv">
                                    Svenska - Swedish
                                  </option>
                                  <option value="vi">
                                    Tiếng Việt - Vietnamese
                                  </option>
                                  <option value="tr">Türkçe - Turkish</option>
                                  <option value="el">Ελληνικά - Greek</option>
                                  <option value="bg">
                                    Български език - Bulgarian
                                  </option>
                                  <option value="ru">
                                    Русский - Russian
                                  </option>
                                  <option value="sr">Српски - Serbian</option>
                                  <option value="uk">
                                    Українська мова - Ukrainian
                                  </option>
                                  <option value="he">
                                    עִבְרִית - Hebrew
                                  </option>
                                  <option value="ur">
                                    اردو - Urdu (beta)
                                  </option>
                                  <option value="ar">العربية - Arabic</option>
                                  <option value="fa">فارسی - Persian</option>
                                  <option value="mr">मराठी - Marathi</option>
                                  <option value="hi">हिन्दी - Hindi</option>
                                  <option value="bn">বাংলা - Bangla</option>
                                  <option value="gu">
                                    ગુજરાતી - Gujarati
                                  </option>
                                  <option value="ta">தமிழ் - Tamil</option>
                                  <option value="kn">ಕನ್ನಡ - Kannada</option>
                                  <option value="th">ภาษาไทย - Thai</option>
                                  <option value="ko">한국어 - Korean</option>
                                  <option value="ja">
                                    日本語 - Japanese
                                  </option>
                                  <option value="zh-cn">
                                    简体中文 - Simplified Chinese
                                  </option>
                                  <option value="zh-tw">
                                    繁體中文 - Traditional Chinese
                                  </option>
                                </select> -->
                              <!--end::Input-->
                              <!-- </div> -->
                              <!--end::Input group-->
                            </div>
                            <!--end::User form-->
                            <!--begin::Address toggle-->
                            <div class="fw-bolder fs-3 rotate collapsible mb-7" data-bs-toggle="collapse" href="#kt_modal_update_user_address" role="button" aria-expanded="true" aria-controls="kt_modal_update_user_address">
                              Address Details
                              <span class="ms-2 rotate-180">
                                <i class="ki-duotone ki-down fs-3"></i>
                              </span>
                            </div>
                            <!--end::Address toggle-->
                            <!--begin::Address form-->
                            <div id="kt_modal_update_user_address" class="collapse show">
                              <!--begin::Input group-->
                              <div class="d-flex flex-column mb-7 fv-row">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">Address</label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <input class="form-control form-control-solid" placeholder="" name="address" value="<%= user?.address %>" />
                                <!--end::Input-->
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <div class="d-flex flex-column mb-7 fv-row">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">City</label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <input class="form-control form-control-solid" placeholder="" name="city" value="<%= user?.city %>" />
                                <!--end::Input-->
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <div class="row g-9 mb-7">
                                <!--begin::Col-->
                                <div class="col-md-6 fv-row">
                                  <!--begin::Label-->
                                  <label class="fs-6 fw-semibold mb-2">State</label>
                                  <!--end::Label-->
                                  <!--begin::Input-->
                                  <input class="form-control form-control-solid" placeholder="" name="state" value="<%= user?.state %>" />
                                  <!--end::Input-->
                                </div>
                                <!--end::Col-->
                                <!--begin::Col-->
                                <div class="col-md-6 fv-row">
                                  <!--begin::Label-->
                                  <label class="fs-6 fw-semibold mb-2">Post Code</label>
                                  <!--end::Label-->
                                  <!--begin::Input-->
                                  <input class="form-control form-control-solid" placeholder="" name="postalCode" value="<%= user?.postalCode %>" />
                                  <!--end::Input-->
                                </div>
                                <!--end::Col-->
                              </div>
                              <!--end::Input group-->
                              <!--begin::Input group-->
                              <div class="d-flex flex-column mb-7 fv-row">
                                <!--begin::Label-->
                                <label class="fs-6 fw-semibold mb-2">
                                  <span>Country</span>
                                  <span class="ms-1" data-bs-toggle="tooltip" title="Country of origination">
                                    <i class="ki-duotone ki-information fs-7">
                                      <span class="path1"></span>
                                      <span class="path2"></span>
                                      <span class="path3"></span>
                                    </i>
                                  </span>
                                </label>
                                <!--end::Label-->
                                <!--begin::Input-->
                                <select name="country" aria-label="Select a Country" data-control="select2" data-placeholder="Select a Country..." class="form-select form-select-solid" data-dropdown-parent="#kt_modal_update_details" name="country">
                                  <option value="">
                                    Select a Country...
                                  </option>
                                  <% countries.forEach(country => { %>
                                  <option value="<%= country.name %>" <%= country.name == user?.country ? 'selected' : '' %>>
                                    <%= country.name %>
                                  </option>
                                  <% }); %>
                                </select>
                                <!--end::Input-->
                              </div>
                              <!--end::Input group-->
                            </div>
                            <!--end::Address form-->
                          </div>
                          <!--end::Scroll-->
                        </div>
                        <!--end::Modal body-->
                        <!--begin::Modal footer-->
                        <div class="modal-footer flex-center">
                          <!--begin::Button-->
                          <button type="reset" class="btn btn-light me-3" data-kt-users-modal-action="cancel">
                            Discard
                          </button>
                          <!--end::Button-->
                          <!--begin::Button-->
                          <button type="submit" class="btn btn-primary" data-kt-users-modal-action="submit">
                            <span class="indicator-label">Submit</span>
                            <span class="indicator-progress">Please wait...
                              <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
                          </button>
                          <!--end::Button-->
                        </div>
                        <!--end::Modal footer-->
                      </form>
                      <!--end::Form-->
                    </div>
                  </div>
                </div>
                <!--end::Modal - Update user details-->
                <!--begin::Modal - Update password-->
                <div class="modal fade" id="kt_modal_update_password" tabindex="-1" aria-hidden="true">
                  <!--begin::Modal dialog-->
                  <div class="modal-dialog modal-dialog-centered mw-650px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                      <!--begin::Modal header-->
                      <div class="modal-header">
                        <!--begin::Modal title-->
                        <h2 class="fw-bold">Update Password</h2>
                        <!--end::Modal title-->
                        <!--begin::Close-->
                        <div class="btn btn-icon btn-sm btn-active-icon-primary" data-kt-users-modal-action="close">
                          <i class="bi bi-x fs-2x"></i>
                        </div>
                        <!--end::Close-->
                      </div>
                      <!--end::Modal header-->
                      <!--begin::Modal body-->
                      <div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
                        <!--begin::Form-->
                        <form id="kt_modal_update_password_form" class="form" data-kt-redirect-url="/dashboard/users/profile" action="/api/users/self/password" method="post">
                          <!--begin::Input group=-->
                          <div class="fv-row mb-10">
                            <label class="required form-label fs-6 mb-2">Current Password</label>
                            <input class="form-control form-control-lg form-control-solid" type="password" placeholder="" name="current_password" autocomplete="off" />
                          </div>
                          <!--end::Input group=-->
                          <!--begin::Input group=-->
                          <div class="fv-row mb-8" data-kt-password-meter="true">
                            <!--begin::Wrapper-->
                            <div class="mb-1">
                              <!--begin::Label-->
                              <label for="password" class="fw-bold text-start text-gray-900 fs-6 mb-2 required">
                                Password
                              </label>
                              <!--end::Label-->
                              <!--begin::Input wrapper-->
                              <div class="position-relative mb-3">
                                <input class="form-control bg-transparent" type="password" placeholder="Password" name="password" autocomplete="off" />
                                <span class="btn btn-sm btn-icon position-absolute translate-middle top-50 end-0 me-n2" data-kt-password-meter-control="visibility">
                                  <i class="fa-regular fa-eye"></i>
                                  <i class="fa-regular fa-eye-slash d-none"></i>
                                </span>
                              </div>
                              <!--end::Input wrapper-->
                              <!--begin::Meter-->
                              <div class="d-flex align-items-center mb-3" data-kt-password-meter-control="highlight">
                                <div class="flex-grow-1 bg-secondary bg-active-success rounded h-5px me-2"></div>
                                <div class="flex-grow-1 bg-secondary bg-active-success rounded h-5px me-2"></div>
                                <div class="flex-grow-1 bg-secondary bg-active-success rounded h-5px me-2"></div>
                                <div class="flex-grow-1 bg-secondary bg-active-success rounded h-5px"></div>
                              </div>
                              <!--end::Meter-->
                            </div>
                            <!--end::Wrapper-->
                            <!--begin::Hint-->
                            <div class="text-muted">
                              Use 8 or more characters with a mix of letters, numbers &
                              symbols.
                            </div>
                            <!--end::Hint-->
                          </div>
                          <!--end::Input group=-->
                          <!--end::Input group=-->
                          <div class="fv-row mb-8" data-kt-password-meter="false">
                            <!--begin::Label-->
                            <label for="password_confirmation" class="fw-bold text-start text-gray-900 fs-6 mb-2 required">
                              Repeat Password
                            </label>
                            <!--end::Label-->

                            <!--begin::Input wrapper-->
                            <div class="position-relative mb-3">
                              <!--begin::Repeat Password-->
                              <input placeholder="Repeat Password" name="password_confirmation" type="password" autocomplete="off" class="form-control bg-transparent" />
                              <!--end::Repeat Password-->
                              <span class="btn btn-sm btn-icon position-absolute translate-middle top-50 end-0 me-n2" data-kt-password-meter-control="visibility">
                                <i class="fa-regular fa-eye"></i>
                                <i class="fa-regular fa-eye-slash d-none"></i>
                              </span>
                            </div>
                            <!--end::Input wrapper-->
                          </div>
                          <!--end::Input group=-->
                          <!--begin::Actions-->
                          <div class="text-center pt-15">
                            <button type="reset" class="btn btn-light me-3" data-kt-users-modal-action="cancel">
                              Discard
                            </button>
                            <button type="submit" class="btn btn-primary" data-kt-users-modal-action="submit">
                              <span class="indicator-label">Submit</span>
                              <span class="indicator-progress">Please wait...
                                <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
                            </button>
                          </div>
                          <!--end::Actions-->
                        </form>
                        <!--end::Form-->
                      </div>
                      <!--end::Modal body-->
                    </div>
                    <!--end::Modal content-->
                  </div>
                  <!--end::Modal dialog-->
                </div>
                <!--end::Modal - Update password-->
                <!--begin::Modal - Add task-->
                <div class="modal fade" id="kt_modal_add_auth_app" tabindex="-1" aria-hidden="true">
                  <!--begin::Modal dialog-->
                  <div class="modal-dialog modal-dialog-centered mw-650px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                      <!--begin::Modal header-->
                      <div class="modal-header">
                        <!--begin::Modal title-->
                        <h2 class="fw-bold">Add Authenticator App</h2>
                        <!--end::Modal title-->
                        <!--begin::Close-->
                        <div class="btn btn-icon btn-sm btn-active-icon-primary" data-kt-users-modal-action="close">
                          <i class="bi bi-x fs-2x"></i>
                        </div>
                        <!--end::Close-->
                      </div>
                      <!--end::Modal header-->
                      <!--begin::Modal body-->
                      <div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
                        <!--begin::Content-->
                        <div class="fw-bold d-flex flex-column justify-content-center mb-5">
                          <!--begin::Label-->
                          <div class="text-center mb-5" data-kt-add-auth-action="qr-code-label">
                            Download the <a href="#">Authenticator app</a>,
                            add a new account, then scan this barcode to set
                            up your account.
                          </div>
                          <div class="text-center mb-5 d-none" data-kt-add-auth-action="text-code-label">
                            Download the <a href="#">Authenticator app</a>,
                            add a new account, then enter this code to set up
                            your account.
                          </div>
                          <!--end::Label-->
                          <!--begin::QR code-->
                          <div class="d-flex flex-center" data-kt-add-auth-action="qr-code">
                            <img src="/assets/media/misc/qr.png" alt="Scan this QR code" />
                          </div>
                          <!--end::QR code-->
                          <!--begin::Text code-->
                          <div class="border rounded p-5 d-flex flex-center d-none" data-kt-add-auth-action="text-code">
                            <div class="fs-1">gi2kdnb54is709j</div>
                          </div>
                          <!--end::Text code-->
                        </div>
                        <!--end::Content-->
                        <!--begin::Action-->
                        <div class="d-flex flex-center">
                          <div class="btn btn-light-primary" data-kt-add-auth-action="text-code-button">
                            Enter code manually
                          </div>
                          <div class="btn btn-light-primary d-none" data-kt-add-auth-action="qr-code-button">
                            Scan barcode instead
                          </div>
                        </div>
                        <!--end::Action-->
                      </div>
                      <!--end::Modal body-->
                    </div>
                    <!--end::Modal content-->
                  </div>
                  <!--end::Modal dialog-->
                </div>
                <!--end::Modal - Add task-->
                <!--begin::Modal - Add task-->
                <div class="modal fade" id="kt_modal_add_one_time_password" tabindex="-1" aria-hidden="true">
                  <!--begin::Modal dialog-->
                  <div class="modal-dialog modal-dialog-centered mw-650px">
                    <!--begin::Modal content-->
                    <div class="modal-content">
                      <!--begin::Modal header-->
                      <div class="modal-header">
                        <!--begin::Modal title-->
                        <h2 class="fw-bold">Enable One Time Password</h2>
                        <!--end::Modal title-->
                        <!--begin::Close-->
                        <div class="btn btn-icon btn-sm btn-active-icon-primary" data-kt-users-modal-action="close">
                          <i class="bi bi-x fs-2x"></i>
                        </div>
                        <!--end::Close-->
                      </div>
                      <!--end::Modal header-->
                      <!--begin::Modal body-->
                      <div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
                        <!--begin::Form-->
                        <form class="form" id="kt_modal_add_one_time_password_form">
                          <!--begin::Label-->
                          <div class="fw-bold mb-9">
                            Enter the new phone number to receive an SMS to
                            when you log in.
                          </div>
                          <!--end::Label-->
                          <!--begin::Separator-->
                          <div class="separator saperator-dashed my-5"></div>
                          <!--end::Separator-->
                          <!--begin::Input group-->
                          <div class="fv-row mb-7">
                            <!--begin::Label-->
                            <label class="fs-6 fw-semibold form-label mb-2">
                              <span class="required">Email</span>
                            </label>
                            <!--end::Label-->
                            <!--begin::Input-->
                            <input type="email" class="form-control form-control-solid" name="otp_email" value="irfan@gmail.com" readonly="readonly" />
                            <!--end::Input-->
                          </div>
                          <!--end::Input group-->
                          <!--begin::Input group-->
                          <div class="fv-row mb-7">
                            <!--begin::Label-->
                            <label class="fs-6 fw-semibold form-label mb-2">
                              <span class="required">Confirm password</span>
                            </label>
                            <!--end::Label-->
                            <!--begin::Input-->
                            <input type="password" class="form-control form-control-solid" name="otp_confirm_password" value="" />
                            <!--end::Input-->
                          </div>
                          <!--end::Input group-->
                          <!--begin::Actions-->
                          <div class="text-center pt-15">
                            <button type="reset" class="btn btn-light me-3" data-kt-users-modal-action="cancel">
                              Cancel
                            </button>
                            <button type="submit" class="btn btn-primary" data-kt-users-modal-action="submit">
                              <span class="indicator-label">Submit</span>
                              <span class="indicator-progress">Please wait...
                                <span class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
                            </button>
                          </div>
                          <!--end::Actions-->
                        </form>
                        <!--end::Form-->
                      </div>
                      <!--end::Modal body-->
                    </div>
                    <!--end::Modal content-->
                  </div>
                  <!--end::Modal dialog-->
                </div>
                <!--end::Modal - Add task-->
                <!--end::Modals-->
              </div>
              <!--end::Content container-->
            </div>
            <!--end::Content-->
          </div>
          <!--end::Content wrapper-->
          <!--begin::Footer-->
          <div id="kt_app_footer" class="app-footer">
            <!--begin::Footer container-->
            <div class="app-container container-fluid d-flex flex-column flex-md-row flex-center flex-md-stack py-3">
              <!--begin::Copyright-->
              <div class="text-gray-900 order-2 order-md-1">
                <span class="text-muted fw-semibold me-1">
                  <script>
                    document.write(new Date().getFullYear());
                  </script>
                  &copy;
                </span>
                <a href="/../index.html" target="_blank" class="text-gray-800 text-hover-primary">
                  Best Trip
                </a>
              </div>
              <!--end::Copyright-->
            </div>
            <!--end::Footer container-->
          </div>
          <!--end::Footer-->
        </div>
        <!--end:::Main-->
      </div>
      <!--end::Wrapper-->
    </div>
    <!--end::Page-->
  </div>
  <!--end::App-->
  <!--begin::Drawers-->
  <!--begin::Activities drawer-->
  <%- include('../partials/activities-drawer.ejs'); %>
  <!--end::Activities drawer-->
  <!--end::Drawers-->
  <!--begin::Scrolltop-->
  <%- include('../partials/scroll-top.ejs'); %>
  <!--end::Scrolltop-->
  <!--begin::Javascript-->
  <%- include('../partials/footer-scripts.ejs', {
    vendorJavascripts: ['/assets/plugins/custom/datatables/datatables.bundle.js'],
    customJavascripts: [
      '/assets/js/custom/apps/user-management/users/view/table.js',
      '/assets/js/custom/apps/user-management/users/view/view.js',
      '/assets/js/custom/apps/user-management/users/view/update-details.js',
      '/assets/js/custom/apps/user-management/users/view/update-password.js',
      '/assets/js/custom/apps/user-management/users/view/update-utils.js',
      '/assets/js/custom/apps/user-management/users/view/add-one-time-password.js'
    ]
  }); %>
  <!--end::Javascript-->
</body>
<!--end::Body-->

</html>